<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout(~{::section})}">
<section>
    <nav class="breadcrumbs" sec:authorize="isAuthenticated()">
        <a th:href="@{/}">Inicio</a>
        <span class="breadcrumb-separator">/</span>
        <a th:href="@{/vehiculos}">Vehículos</a>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-current" th:text="${isEdit} ? 'Editar' : 'Nuevo'">Formulario</span>
    </nav>
    <div class="page-header">
        <div>
            <h1 th:text="${isEdit} ? 'Editar vehículo' : 'Nuevo vehículo'">Formulario</h1>
            <p th:text="${isEdit} ? 'Modifica los datos del vehículo' : 'Registra un nuevo vehículo en el sistema'">
                Descripción del formulario
            </p>
        </div>
        <a class="button" th:href="@{/vehiculos}">
            <svg class="button-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            Volver
        </a>
    </div>

    <div class="card form-card">
        <form th:action="@{${action}}" th:object="${vehiculo}" method="post">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            
            <div class="form-section">
                <div class="form-section-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                    </svg>
                    <h3>Propietario</h3>
                </div>
                <div class="form-grid single-col">
                    <div class="form-field">
                        <label class="form-label" for="cliente">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                <circle cx="12" cy="7" r="4"/>
                            </svg>
                            Cliente propietario
                            <span class="required">*</span>
                        </label>
                        <select id="cliente" class="form-select" th:field="*{cliente.idCliente}" required>
                            <option value="" disabled
                                    th:selected="${vehiculo.cliente == null || vehiculo.cliente.idCliente == null}">
                                -- Selecciona el propietario del vehículo --
                            </option>
                            <option th:each="cliente : ${clientes}"
                                    th:value="${cliente.idCliente}"
                                    th:text="${cliente.nombre}">
                                Cliente
                            </option>
                        </select>
                        <span class="form-hint">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 16v-4M12 8h.01"/>
                            </svg>
                            Cliente registrado al que pertenece el vehículo
                        </span>
                        <div class="form-error" th:if="${#fields.hasErrors('cliente')}">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 8v4M12 16h.01"/>
                            </svg>
                            <span th:errors="*{cliente}">Error</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="form-section-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 17h14v-4H5z"/>
                        <path d="M19 3H5C3.9 3 3 3.9 3 5v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>
                    </svg>
                    <h3>Datos del vehículo</h3>
                </div>
                <div class="form-grid">
                    <div class="form-field">
                        <label class="form-label" for="matricula">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="6" width="18" height="12" rx="2"/>
                                <path d="M7 10h10M7 14h6"/>
                            </svg>
                            Matrícula
                            <span class="required">*</span>
                        </label>
                        <input id="matricula" type="text" class="form-input" th:field="*{matricula}" 
                               placeholder="Ej: 1234 ABC" required maxlength="20">
                        <span class="form-hint">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 16v-4M12 8h.01"/>
                            </svg>
                            Debe ser única en el sistema
                        </span>
                        <div class="form-error" th:if="${#fields.hasErrors('matricula')}">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 8v4M12 16h.01"/>
                            </svg>
                            <span th:errors="*{matricula}">Error</span>
                        </div>
                    </div>

                    <div class="form-field">
                        <label class="form-label" for="anio">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                <path d="M16 2v4M8 2v4M3 10h18"/>
                            </svg>
                            Año de fabricación
                        </label>
                        <input id="anio" type="number" class="form-input" th:field="*{anio}" 
                               min="1900" max="2100" placeholder="Ej: 2020">
                        <div class="form-error" th:if="${#fields.hasErrors('anio')}">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 8v4M12 16h.01"/>
                            </svg>
                            <span th:errors="*{anio}">Error</span>
                        </div>
                    </div>

                    <div class="form-field">
                        <label class="form-label" for="marca">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                                <path d="M2 17l10 5 10-5M2 12l10 5 10-5"/>
                            </svg>
                            Marca
                        </label>
                        <input id="marca" type="text" class="form-input" th:field="*{marca}" 
                               placeholder="Ej: Ford, Seat, Renault...">
                        <div class="form-error" th:if="${#fields.hasErrors('marca')}">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 8v4M12 16h.01"/>
                            </svg>
                            <span th:errors="*{marca}">Error</span>
                        </div>
                    </div>

                    <div class="form-field">
                        <label class="form-label" for="modelo">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                            </svg>
                            Modelo
                        </label>
                        <input id="modelo" type="text" class="form-input" th:field="*{modelo}" 
                               placeholder="Ej: Focus, Ibiza, Clio...">
                        <div class="form-error" th:if="${#fields.hasErrors('modelo')}">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 8v4M12 16h.01"/>
                            </svg>
                            <span th:errors="*{modelo}">Error</span>
                        </div>
                    </div>

                    <div class="form-field full-width">
                        <label class="form-label" for="kmActual">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v6l4 2"/>
                            </svg>
                            Kilometraje actual
                        </label>
                        <div class="input-icon-group">
                            <input id="kmActual" type="number" class="form-input with-addon" th:field="*{kmActual}" 
                                   min="0" step="1" placeholder="Ej: 50000">
                            <span class="input-addon">km</span>
                        </div>
                        <span class="form-hint">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 16v-4M12 8h.01"/>
                            </svg>
                            Se usará para calcular recordatorios por kilometraje
                        </span>
                        <div class="form-error" th:if="${#fields.hasErrors('kmActual')}">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 8v4M12 16h.01"/>
                            </svg>
                            <span th:errors="*{kmActual}">Error</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button class="button primary" type="submit">
                    <svg class="button-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                        <path d="M17 21v-8H7v8M7 3v5h8"/>
                    </svg>
                    <span th:text="${isEdit} ? 'Guardar cambios' : 'Crear vehículo'">Guardar</span>
                </button>
                <a class="button" th:href="@{/vehiculos}">Cancelar</a>
            </div>
        </form>
    </div>
</section>
</html>
